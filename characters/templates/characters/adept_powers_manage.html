{% extends 'base.html' %}
{% load static %}

{% block title %}{{ character.name }} - Adept Powers{% endblock %}

{% block extra_css %}
<style>
    .power-card {
        border-left: 4px solid #f59e0b;
        margin-bottom: 10px;
        transition: all 0.2s;
    }

    .power-card:hover {
        box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
        transform: translateX(2px);
    }

    .powers-header {
        background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
        color: white;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .power-point-badge {
        font-size: 1.1em;
        font-weight: bold;
        padding: 6px 12px;
        border-radius: 20px;
        background-color: #f59e0b;
        color: white;
        display: inline-block;
    }

    .level-badge {
        background-color: #10b981;
        color: white;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 0.9em;
        font-weight: bold;
    }

    .no-powers-message {
        text-align: center;
        padding: 40px;
        color: #6c757d;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2>
                <i class="bi bi-lightning-charge"></i>
                {{ character.name }} - Adept Powers
            </h2>
            <p class="text-muted">Manage your character's adept powers</p>
        </div>
        <div>
            <a href="{% url 'characters:detail' character.pk %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Back to Character
            </a>
            <a href="{% url 'characters:adept_power_add' character.pk %}" class="btn btn-primary">
                <i class="bi bi-plus-circle"></i> Add Power
            </a>
        </div>
    </div>

    <!-- Magic Rating Info -->
    <div class="powers-header">
        <h4 class="mb-2"><i class="bi bi-gem"></i> Magic & Power Points</h4>
        <div class="row">
            <div class="col-md-6">
                <strong>Magic Rating:</strong> {{ character.magic }}
            </div>
            <div class="col-md-6">
                <strong>Available Power Points:</strong> {{ character.magic }}
            </div>
        </div>
    </div>

    <!-- Adept Powers List -->
    {% if adept_powers %}
        {% for character_power in adept_powers %}
        <div class="card power-card">
            <div class="card-body">
                <div class="row align-items-center">
                    <!-- Power Point Cost -->
                    <div class="col-auto">
                        <div class="power-point-badge" title="Power Point Cost">
                            {{ character_power.power.cost }} PP
                        </div>
                    </div>

                    <!-- Power Info -->
                    <div class="col">
                        <h5 class="mb-1">
                            {{ character_power.power.name }}
                            <span class="level-badge">Level {{ character_power.level }}</span>
                        </h5>
                        <small class="text-muted">
                            <strong>Total Cost:</strong> {% widthratio character_power.power.cost 1 character_power.level %} PP
                            {% if character_power.notes %}
                                <br>{{ character_power.notes }}
                            {% endif %}
                        </small>
                        {% if character_power.power.description %}
                            <p class="mb-0 mt-2 small">{{ character_power.power.description }}</p>
                        {% endif %}
                    </div>

                    <!-- Actions -->
                    <div class="col-auto">
                        <a href="{% url 'characters:adept_power_edit' character.pk character_power.pk %}"
                           class="btn btn-sm btn-outline-primary" title="Edit">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <a href="{% url 'characters:adept_power_delete' character.pk character_power.pk %}"
                           class="btn btn-sm btn-outline-danger" title="Delete">
                            <i class="bi bi-trash"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="card">
            <div class="card-body no-powers-message">
                <i class="bi bi-lightning-charge" style="font-size: 3em; color: #f59e0b;"></i>
                <h4 class="mt-3">No Adept Powers Yet</h4>
                <p class="text-muted">Add adept powers to enhance your physical abilities</p>
                <a href="{% url 'characters:adept_power_add' character.pk %}" class="btn btn-primary mt-2">
                    <i class="bi bi-plus-circle"></i> Add Your First Power
                </a>
            </div>
        </div>
    {% endif %}

    <!-- Summary Stats -->
    <div class="card mt-4">
        <div class="card-header">
            <h5 class="mb-0"><i class="bi bi-bar-chart"></i> Power Summary</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-4">
                    <strong>Total Powers:</strong> {{ adept_powers.count }}
                </div>
                <div class="col-md-4">
                    <strong>Magic Rating:</strong> {{ character.magic }}
                </div>
                <div class="col-md-4">
                    <strong>Power Points Available:</strong> {{ character.magic }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
